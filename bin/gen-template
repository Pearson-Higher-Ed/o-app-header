#!/usr/bin/env node

'use strict';

const path = require('path');
const fs = require('fs');
const superviews = require('superviews.js');

const PREAMBLE = `/* jshint ignore: start */

// *** DO NOT MODIFY THIS FILE ***
// This file was generated from src/html/header.template
// Regenerate using bin/gen-template

import incrementalDom from '../../lib/incremental-dom';
import {
  elementOpen,
  elementClose,
  elementVoid,
  text } from '../../lib/incremental-dom';

export default template;

`;

function printUsage() {
  console.log('usage: gen-template source_file target_file');
}

function main(argv) {
  if (argv.length !== 2) {
    printUsage();
    process.exit(1);
  }

  const sourcePath = path.resolve(argv[0]);
  const destPath = path.resolve(argv[1]);

  const buffer = fs.readFileSync(sourcePath);

  const outStream = fs.createWriteStream(destPath);

  outStream.write(PREAMBLE);
  outStream.write(superviews(buffer));
  outStream.end();
}

main(process.argv.slice(2));
